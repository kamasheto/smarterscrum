<!--Author: Amr Tj.Wallas-->
<!--Task: C1S3-->
#{extends 'CRUD/layout.html' /}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<head>
	<script src="@{'/public/javascripts/jquery-1.4.min.js'}" type="text/javascript" charset="utf-8"></script>
</head>

<div id="crudList" class="${type.name}">
	
	<h2 id="crudListTitle">&{'crud.list.title', type.name}</h2>
	
	<!-- Search for logs -->
	<div id="search">
	<form name="input" method = "get">
	Search:
	<input type="text" name="filter" id = "text" value="e.g mE SmArtsOfT" onfocus="this.value='';" />
	<input type="submit" value="Search" />
	</form> 
	
	</div>
	#{note 'highlight'} <p style = "color:blue;"> The search ignores case. i.e "SmArTsOfT" is the same as "smartsoft"<br /><br />
	The search is also very smart. Meaning that u can search logs by anything (user, project, date, ... etc)) just type in your keyword and the search engine would understand you and what you wanna search for<br /><br />
	 You can search for "SmARTSOft mE" or "Me SMARTsoFt" which would yield all logs related to Project "smartsoft" and User "me"<br /><br />
If you typed a user name and a project name that do not exist on the system, The search is clever enough to Show you the nearest results. For Example: "SmartSoft kkk" would yield logs related to the smartsoft project since there are no logs with user , resource type , ... etc) that match kkk</p>
	#{/note}
	<br />
	#{if logs != null && !logs.isEmpty()}
	#{if filter}
	<font size="3">You are currently viewing logs that match the Keyword: <font color="red">${filter.toLowerCase();}</font> &nbsp; <font size="1"><a href="/admin/logs"> view all logs? </a></font></font> 
	<script type="text/javascript">
		$('#text').val('${filter.toLowerCase();}');
	</script>
	#{/if}
 	<!--List Rendered logs-->
	<div id="list">
		<br />
	#{list items:logs, as:'log'}
		 #{if (log.logMessage)}
		 #{if !(log.madeBySysAdmin)}
		 [${log.date}]:  ${log.logMessage}<br />
		 #{/if}
		 #{else}
		 <font color="red"><b>[${log.date}]:  (SysAdmin) ${log.logMessage}</b></font><br />
		 #{/else}
		 #{/if}
		 #{else}
	     #{if log.madeBySysAdmin}
		 <font color="red"><b>[${log.date}]:  (SysAdmin) <a href = "/show/user?id=${log.user.id}">${log.user.name}</a> has ${log.action_type}ed a ${log.resource_type} with id ${log.resource_id} in <a href="/show/project?id=${log.project.id}">${log.project.name}</a></b></font> <br /> 
		 #{/if}
		 #{else}
		 [${log.date}]:  <a href = "/show/user?id=${log.user.id}">${log.user.name}</a> has ${log.action_type}ed a ${log.resource_type} with id ${log.resource_id} in <a href="/show/project?id=${log.project.id}">${log.project.name}</a> <br />
		 #{/else}
		 #{/else}
	#{/list}
	</div>
	<br />
	<!--Pagination for each page-->
	<div id="pagination">
	#{if !logs.isEmpty() && logs.get(0).prev() && page != 0}
	<a href = "logs?page=${page-1}&filter=${filter}"> Previous </a> ||
	#{/if}
	
	#{if !logs.isEmpty() && log.next() && (page+1)< (log.count()/25) && !(logs.size()<25)}
	<a href = "logs?page=${page+1}&filter=${filter}"> Next </a>  
	#{/if}
	#{/if}
	#{else}
	<font color="red">No Logs found.</font>
	#{/else}
	</div>
	<!--
	<p id="crudListAdd">
		<a href="@{blank()}">&{'crud.add', type.modelName}</a>
	</p>
	-->
 
</div>
